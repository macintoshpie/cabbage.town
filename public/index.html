<!DOCTYPE html>
<html>

<head>
    <title>c.t</title>
    <link rel="icon" href="icon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="reset.css">
    <style>
        @font-face {
            font-family: 'Cooper Black Regular';
            font-style: normal;
            font-weight: normal;
            src: local('Cooper Black Regular'), url('COOPBL.woff') format('woff');
        }

        :root {
            --dagreen: rgb(36, 221, 35);
            --dayellow: rgb(255, 237, 182);
            --daorange: rgb(250, 134, 37);
        }

        .syne-mono-regular {
            font-family: "Cooper Black Regular", monospace;
            font-style: normal;
        }

        body {
            /* background: rgb(241, 179, 255); */
            background: var(--dayellow);
            color: black;
            font-family: 'Courier New', Courier, monospace;
            /* font-family: 'Arial', sans-serif; */
            margin: 0;
            cursor:
                url(cursor-tnt-0.png) 4 12,
                auto;
        }

        i {
            font-style: italic;
        }

        em {
            font-weight: bold;
        }

        h2 {
            font-size: 2em;
            margin: 0;
        }

        h3 {
            font-size: 1.5em;
            margin: 0;
        }

        .bullet {
            list-style: circle;
            list-style-position: inside;
        }

        .live {}

        .main {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
        }

        .content {
            display: flex;
            flex-direction: column;
            justify-content: center;
            max-width: 500px;
            gap: 16px;
            padding-left: 16px;
            padding-right: 16px;
        }

        .socials {
            display: flex;
            gap: 32px;
            align-items: center;
            justify-content: center;
        }

        a {
            color: blue;
        }

        .song-details-container {
            /* colors configured in admin dash: https://radio.cabbage.town/station/1/branding */
            border: 16px ridge var(--daorange);
            padding: 8px;
            border-radius: 16px;
            background-color: white;
        }

        .now-playing-container {
            display: flex;
            flex-direction: row;
            gap: 8px;
        }

        @media (max-width: 600px) {
            .now-playing-container {
                flex-direction: column;
                align-items: center;
                /* optional, for centering */
                gap: 8px;
                /* optional spacing between stacked elements */
            }
        }

        .sched-day {
            color: rgb(90, 90, 90);
        }

        .sched-day ul {
            padding-left: 20px;
        }

        .tune-tank {
            color: rgb(168, 168, 168);
        }

        .tune-tank-item {
            font-weight: bold;
        }

        .tune-tank-item ul {
            padding-left: 20px;
            font-weight: normal;
        }

        .mulch-channel {
            color: rgb(141, 61, 61);
        }

        .reginajingles-channel {
            color: rgb(53, 174, 43);
        }

        .ben {
            color: rgb(0, 111, 166);
        }

        .terminus {
            color: rgb(180, 32, 234);
        }

        .nlt {
            color: rgb(116, 22, 184);
        }

        .home-cooking {
            color: rgb(174, 52, 4);
        }

        .posted-up {
            color: rgb(168, 168, 168);
        }

        .show {
            font-size: 20px;
            font-weight: bold;
        }

        :root {
            --marquee-speed: 10s;
            /* default, will be overridden */
        }

        @media (min-width: 600px) {
            :root {
                --marquee-speed: 15s;
            }
        }

        @media (min-width: 1000px) {
            :root {
                --marquee-speed: 20s;
            }
        }


        .scrolling-banner {
            overflow: hidden;
            position: relative;
            height: 1em;
        }

        .scrolling-text {
            display: inline-block;
            white-space: nowrap;
            position: absolute;
            animation: scroll var(--marquee-speed, 10s) linear infinite alternate;
        }

        @keyframes scroll {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(calc(100vw - 100%));
            }
        }

        button {
            background: none;
            border: none;
            padding: 0;
            cursor: pointer;
        }

        .the-producer {
            color: rgb(255, 0, 0);
        }

        #liveStreamerName {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--dagreen);
            text-align: center;
            word-break: break-word;
            overflow-wrap: break-word;
        }
    </style>
</head>

<body>
    <div class="scrolling-banner" style="background-color: var(--daorange); color: white; font-weight: bold;">
        <div class="scrolling-text" id="live-show-banner"></div>
    </div>
    <div class="main">
        <img src="the-cabbage.png" style="width: 80px; height: auto" alt="cabbage">
        <h2 class="syne-mono-regular">cabbage.town</h2>
        <p style="text-align: center; font-size: small;"><i>atlanta's #1 organic internet radio station</i></p>

        <div class="content" style="padding-top: 16px;">
            <br>
            <div class="now-playing-container">
                <img class="song-details-container" id="nowPlayingArtwork" src="the-cabbage.png"
                    alt="now playing artwork"
                    style="max-height: 150px; border-radius: 16px; width: 100%; aspect-ratio: 1 / 1; object-fit:contain; border-radius: 16px; max-width: 150px;" />
                <div class="song-details-container"
                    style="display: flex; flex-direction: row; justify-content: space-between; align-items: flex-start; gap: 16px; flex-grow: 1; height: fit-content;">
                    <div
                        style="display: flex; flex-direction: column; gap: 8px; align-items: flex-start; flex-grow: 1;">
                        <p id="liveStreamerName" class="live"
                            style="font-size: 1.25em; word-break: break-word; overflow-wrap: break-word; display: none;">
                            .... .... ....
                        </p>
                        <p id="nowPlayingArtist"
                            style="font-size: 1.25em; word-break: break-word; overflow-wrap: break-word;">.... .... ....
                        </p>
                        <p id="nowPlayingTitle"
                            style="font-size: 1.25em; word-break: break-word; overflow-wrap: break-word;">.... .... ....
                        </p>
                    </div>


                    <button id="play" style="display: flex; gap: 8px; align-items: center;">
                        <svg width="50" height="50" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="50" cy="50" r="45" fill="#2e7d32" />
                            <path d="M40,30 L70,50 L40,70 Z" fill="white" />
                        </svg>
                    </button>

                    <button id="stop" style="display: none; gap: 8px; align-items: center;">
                        <svg width="50" height="50" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="50" cy="50" r="45" fill="#d32f2f" />
                            <rect x="35" y="35" width="30" height="30" fill="white" />
                        </svg>
                    </button>
                </div>
            </div>
            <audio id="radio" src="https://radio.cabbage.town:8000/radio.mp3" preload="none"></audio>

            <h3 class="syne-mono-regular">previous shows</h3>
            <div id="recordings-container"
                style="max-height: 300px; overflow-y: auto; background: white; border-radius: 32px; padding: 32px;">
                <div id="recordings-list" style="display: flex; flex-direction: column; gap: 12px;">
                    <!-- Shows will be populated here -->
                </div>
            </div>

            <script>
                // partially borrowed logic from original azuracast player
                // https://github.com/AzuraCast/AzuraCast/blob/8783383563a538b3e06f3dca4dbe65b2202cec99/frontend/components/Common/AudioPlayer.vue
                const radio = document.getElementById("radio");
                const playBtn = document.getElementById("play");
                const stopBtn = document.getElementById("stop");

                let isPlaying = false;

                function stopRadio() {
                    radio.pause();
                    radio.src = "";
                    radio.load();
                    isPlaying = false;

                    playBtn.style.display = "flex";
                    stopBtn.style.display = "none";
                }

                function playRadio() {
                    // force fresh stream each time
                    let url = "https://radio.cabbage.town:8000/radio.mp3";
                    if (navigator.userAgent.includes("Firefox")) {
                        url += "?refresh=" + Date.now(); // bust cache
                    }

                    radio.src = url;
                    radio.load();

                    radio.play().then(() => {
                        isPlaying = true;
                        playBtn.style.display = "none";
                        stopBtn.style.display = "flex";
                    }).catch(err => {
                        console.warn("playback failed", err);
                    });
                }

                playBtn.onclick = () => {
                    if (isPlaying) stopRadio();
                    playRadio();
                };

                stopBtn.onclick = () => {
                    stopRadio();
                };

                radio.onerror = (e) => {
                    const err = radio.error;
                    if (err?.code === MediaError.MEDIA_ERR_NETWORK) {
                        console.log("stream error, retrying in 5s...");
                        setTimeout(playRadio, 5000);
                    }
                };

                radio.onended = stopRadio;
            </script>

            <script>
                document.addEventListener('DOMContentLoaded', () => {
                    const mainRadio = document.getElementById('radio');
                    const recordingPlayers = [];

                    async function fetchAndDisplayRecordings() {
                        try {
                            const response = await fetch('/feed.xml');
                            const text = await response.text();
                            const parser = new DOMParser();
                            const xmlDoc = parser.parseFromString(text, 'text/xml');
                            const items = xmlDoc.getElementsByTagName('item');

                            const recordingsList = document.getElementById('recordings-list');
                            recordingsList.innerHTML = ''; // Clear existing content

                            Array.from(items).forEach(item => {
                                const title = item.getElementsByTagName('title')[0].textContent;
                                const date = new Date(item.getElementsByTagName('pubDate')[0].textContent);
                                const audioUrl = item.getElementsByTagName('enclosure')[0].getAttribute('url');

                                const formattedDate = date.toLocaleDateString('en-US', {
                                    month: 'long',
                                    day: 'numeric',
                                    year: 'numeric'
                                });

                                const showElement = document.createElement('div');
                                showElement.style.cssText = `
                                    display: flex;
                                    justify-content: space-between;
                                    align-items: center;
                                    gap: 8px;
                                    padding: 4px;
                                    border-radius: 8px;
                                    transition: background-color 0.2s;
                                `;

                                // Create info section (left side)
                                const infoSection = document.createElement('div');
                                infoSection.style.cssText = `
                                    display: flex;
                                    flex-direction: column;
                                    gap: 4px;
                                    flex-grow: 1;
                                `;
                                infoSection.innerHTML = `
                                    <div style="font-family: 'Courier New', monospace; font-weight: bold;">${title}</div>
                                    <div style="color: #666; font-family: 'Courier New', monospace;">${formattedDate}</div>
                                `;

                                // Create play button (right side)
                                const playButton = document.createElement('button');
                                playButton.style.cssText = `
                                    background: black;
                                    border: none;
                                    border-radius: 50%;
                                    width: 20px;
                                    height: 20px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    cursor: pointer;
                                    flex-shrink: 0;
                                    padding: 0;
                                `;

                                // Add play icon SVG
                                playButton.innerHTML = `
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 5v14l11-7z" fill="white"/>
                                    </svg>
                                `;

                                let audioElement = null;

                                playButton.onclick = () => {
                                    if (!audioElement) {
                                        // Create audio element only when first clicked
                                        audioElement = document.createElement('audio');
                                        audioElement.style.display = 'none';

                                        // When a recording starts playing
                                        audioElement.onplay = () => {
                                            // Stop the main radio using the existing stopRadio function
                                            if (typeof stopRadio === 'function') {
                                                stopRadio();
                                            }

                                            // Stop other recordings
                                            recordingPlayers.forEach(player => {
                                                if (player !== audioElement) {
                                                    player.pause();
                                                    player.currentTime = 0;
                                                }
                                            });

                                            // Update button to pause icon
                                            playButton.innerHTML = `
                                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" fill="white"/>
                                                </svg>
                                            `;
                                        };

                                        audioElement.onpause = () => {
                                            // Update button back to play icon
                                            playButton.innerHTML = `
                                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M8 5v14l11-7z" fill="white"/>
                                                </svg>
                                            `;
                                        };

                                        // Add source and load only when clicked
                                        const source = document.createElement('source');
                                        source.src = audioUrl;
                                        source.type = 'audio/mpeg';
                                        audioElement.appendChild(source);

                                        // Handle loading states
                                        playButton.style.opacity = '0.5';

                                        audioElement.onloadeddata = () => {
                                            playButton.style.opacity = '1';
                                            audioElement.play();
                                        };

                                        // Handle loading error
                                        audioElement.onerror = () => {
                                            playButton.style.opacity = '1';
                                            playButton.style.backgroundColor = '#d32f2f';
                                        };

                                        recordingPlayers.push(audioElement);
                                        showElement.appendChild(audioElement);
                                    } else {
                                        // Toggle play/pause if audio element exists
                                        if (audioElement.paused) {
                                            audioElement.play();
                                        } else {
                                            audioElement.pause();
                                        }
                                    }
                                };

                                showElement.appendChild(infoSection);
                                showElement.appendChild(playButton);
                                recordingsList.appendChild(showElement);
                            });

                            // Add listener to main radio to stop recordings when it plays
                            mainRadio.addEventListener('play', () => {
                                recordingPlayers.forEach(player => {
                                    player.pause();
                                    player.currentTime = 0;
                                });
                            });

                        } catch (error) {
                            console.error('Error fetching recordings:', error);
                            const recordingsList = document.getElementById('recordings-list');
                            recordingsList.innerHTML = '<p style="color: red;">Error loading recordings. Please try again later.</p>';
                        }
                    }

                    // Load recordings list when the page loads
                    fetchAndDisplayRecordings();
                });
            </script>

            <h3 class="syne-mono-regular">news</h3>
            <div
                style="display: flex; gap: 8px; align-items: flex-start; flex-direction: column; background-color: white; border-radius: 32px; padding: 32px; font-size: 0.8em;">
                <div style="display: flex; gap: 8px; align-items: center;">
                    <p style="flex-grow: 1; font-style: italic; text-align: start;">
                        <em class="terminus">the conductor</em> has entered the cabbage patch (new dj!)
                        <br />
                        &nbsp;<em style="align-self: flex-end;">tune in tuesdays
                            10pm-11pm</em>
                    </p>
                </div>
                <div style="display: flex; gap: 8px; align-items: center;">
                    <p style="flex-grow: 1; font-style: italic; text-align: start;">
                        <em class="home-cooking">Home Cooking</em> has entered the cabbage patch (new curated show!)
                        <br />
                        &nbsp;<em style="align-self: flex-end;">tune in Fri/Sat/Sun
                            8:30-10:30am</em>
                    </p>
                </div>
                <div style="display: flex; gap: 8px; align-items: center;">
                    <p style="flex-grow: 1; font-style: italic; text-align: start;">
                        <em class="ben">DJ Chicago Style</em> has entered the cabbage patch (new dj!)
                        <br />
                        &nbsp;<em style="align-self: flex-end;">tune in tuesdays
                            8-9pm</em>
                    </p>
                </div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <p style="flex-grow: 1; font-style: italic; text-align: start;">
                        <em class="reginajingles-channel">reginajingles</em> has entered the cabbage patch (new dj!)
                        <br />
                        &nbsp;<em>tune in wednesdays 9-10pm</em>
                    </p>
                </div>
                <!-- <hr width="100%" style="border: 1px solid black; margin: 0; opacity: 0.2;" />
                <div style="display: flex; gap: 10px; align-items: center;">

                    <p style="flex-grow: 1; text-align: start;">
                        <em class="the-producer"> <img src="the-cabbage.png" alt="the cabbage"
                                style="width: 1em; height: auto;" /> The Producer:</em>
                        We're doing our first community program, "Hey Hey It's Saturday," April 26th. We'll set up a
                        tent
                        and mobile
                        studio in Cabbagetown Park from 12p til 3p, taking song
                        requests and having YOU start your own show. Drop by and say hi!
                    </p>
                </div> -->
            </div>

            <p>
            <h3 class="syne-mono-regular">schedule</h3>
            <p class="live" style="text-align: center;">
                (LIVE) = live broadcast
            </p>
            <ul style="background-color: white; border-radius: 32px; padding: 32px">
                <li class="sched-day">monday
                    <ul>
                        <!-- <li class="tune-tank">8pm - 9pm: tune tank</li> -->
                        <li class="live show mulch-channel">9pm - 10pm: (LIVE) the mulch channel w/ ted</li>
                    </ul>
                </li>
                <li class="sched-day">tuesday
                    <ul>
                        <!-- <li class="tune-tank">7pm - 8pm: tune tank</li> -->
                        <li class="live show ben">8pm - 9pm: (LIVE) DJ Chicago Style Presents: The IS WiLD hour</li>
                        <li class="live show terminus">10pm - 11pm: (LIVE) tracks from terminus w/ the conductor</li>
                    </ul>
                </li>
                <li class="sched-day">wednesday
                    <ul>
                        <!-- <li class="tune-tank">8pm - 9pm: tune tank</li> -->
                        <li class="live show reginajingles-channel">9pm - 10pm: (LIVE) The reginajingles Show w/
                            reginajingles</li>
                    </ul>
                </li>
                <li class="sched-day">thursday
                    <ul>
                        <!-- <li class="tune-tank">8pm - 9pm: tune tank</li> -->
                        <li class="live show nlt">9pm - 10pm: (LIVE) Late Nights Like These w/ Nights Like These</li>
                    </ul>
                </li>
                <li class="sched-day">friday
                    <ul>
                        <li class="home-cooking show">8:30-10:30am: (CURATED) Home Cooking w/ Seth</li>
                        <!-- <li class="tune-tank">8pm - 9pm: tune tank</li> -->
                    </ul>
                </li>
                <li class="sched-day">saturday
                    <ul>
                        <li class="posted-up">3am - 4am: "posted up"</li>
                        <li class="home-cooking show">8:30-10:30am: (CURATED) Home Cooking w/ Seth</li>
                        <!-- <li class="tune-tank">8pm - 9pm: tune tank</li> -->
                    </ul>
                </li>
                <li class="sched-day">sunday
                    <ul>
                        <li class="home-cooking show">8:30-10:30am: (CURATED) Home Cooking w/ Seth</li>
                        <!-- <li class="tune-tank">8pm - 9pm: tune tank</li> -->
                    </ul>
                </li>
            </ul>

            </p>

            <h3 class="syne-mono-regular">tune tank</h3>
            <p style="font-size: 0.8em">
                We throw out a theme, you share your best song picks, and we play them on the air
                from 8-9pm every night.
                Maybe The Cabbage picks a winner. Maybe it's just vibes. Either way, hear what your fellow cabbages are
                listening to.</p>
            <ul>
                <li class="tune-tank-item">theme
                    <ul>
                        <!-- <li>Love Hangover - songs about romance, heartbreak, or moving on.</li> -->
                        <li>We'll have a new theme soon, check back later!</li>
                    </ul>
                </li>
                <!-- <li class="tune-tank-item">due
                    <ul>
                        <li>march 3rd 11pm</li>
                    </ul>
                </li> -->
            </ul>

            <!-- <a href="/tank">submit tune tank songs here</a> -->

            <br />

            <p class="socials">
                <a href="https://discord.gg/MMYWXMjcmP" target="_blank">
                    <svg width="30" height="30" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M5.07451 1.82584C5.03267 1.81926 4.99014 1.81825 4.94803 1.82284C4.10683 1.91446 2.82673 2.36828 2.07115 2.77808C2.02106 2.80525 1.97621 2.84112 1.93869 2.88402C1.62502 3.24266 1.34046 3.82836 1.11706 4.38186C0.887447 4.95076 0.697293 5.55032 0.588937 5.98354C0.236232 7.39369 0.042502 9.08728 0.0174948 10.6925C0.0162429 10.7729 0.0351883 10.8523 0.0725931 10.9234C0.373679 11.496 1.02015 12.027 1.66809 12.4152C2.32332 12.8078 3.08732 13.1182 3.70385 13.1778C3.85335 13.1922 4.00098 13.1358 4.10282 13.0255C4.2572 12.8581 4.5193 12.4676 4.71745 12.1643C4.80739 12.0267 4.89157 11.8953 4.95845 11.7901C5.62023 11.9106 6.45043 11.9801 7.50002 11.9801C8.54844 11.9801 9.37796 11.9107 10.0394 11.7905C10.1062 11.8957 10.1903 12.0269 10.2801 12.1643C10.4783 12.4676 10.7404 12.8581 10.8947 13.0255C10.9966 13.1358 11.1442 13.1922 11.2937 13.1778C11.9102 13.1182 12.6742 12.8078 13.3295 12.4152C13.9774 12.027 14.6239 11.496 14.925 10.9234C14.9624 10.8523 14.9813 10.7729 14.9801 10.6925C14.9551 9.08728 14.7613 7.39369 14.4086 5.98354C14.3003 5.55032 14.1101 4.95076 13.8805 4.38186C13.6571 3.82836 13.3725 3.24266 13.0589 2.88402C13.0214 2.84112 12.9765 2.80525 12.9264 2.77808C12.1708 2.36828 10.8907 1.91446 10.0495 1.82284C10.0074 1.81825 9.96489 1.81926 9.92305 1.82584C9.71676 1.85825 9.5391 1.96458 9.40809 2.06355C9.26977 2.16804 9.1413 2.29668 9.0304 2.42682C8.86968 2.61544 8.71437 2.84488 8.61428 3.06225C8.27237 3.03501 7.90138 3.02 7.5 3.02C7.0977 3.02 6.72593 3.03508 6.38337 3.06244C6.28328 2.84501 6.12792 2.61549 5.96716 2.42682C5.85626 2.29668 5.72778 2.16804 5.58947 2.06355C5.45846 1.96458 5.2808 1.85825 5.07451 1.82584ZM11.0181 11.5382C11.0395 11.5713 11.0615 11.6051 11.0838 11.6392C11.2169 11.843 11.3487 12.0385 11.4508 12.1809C11.8475 12.0916 12.352 11.8818 12.8361 11.5917C13.3795 11.2661 13.8098 10.8918 14.0177 10.5739C13.9852 9.06758 13.7993 7.50369 13.4773 6.21648C13.38 5.82759 13.2038 5.27021 12.9903 4.74117C12.7893 4.24326 12.5753 3.82162 12.388 3.5792C11.7376 3.24219 10.7129 2.88582 10.0454 2.78987C10.0308 2.79839 10.0113 2.81102 9.98675 2.82955C9.91863 2.881 9.84018 2.95666 9.76111 3.04945C9.71959 3.09817 9.68166 3.1471 9.64768 3.19449C9.953 3.25031 10.2253 3.3171 10.4662 3.39123C11.1499 3.6016 11.6428 3.89039 11.884 4.212C12.0431 4.42408 12.0001 4.72494 11.788 4.884C11.5759 5.04306 11.2751 5.00008 11.116 4.788C11.0572 4.70961 10.8001 4.4984 10.1838 4.30877C9.58933 4.12585 8.71356 3.98 7.5 3.98C6.28644 3.98 5.41067 4.12585 4.81616 4.30877C4.19988 4.4984 3.94279 4.70961 3.884 4.788C3.72494 5.00008 3.42408 5.04306 3.212 4.884C2.99992 4.72494 2.95694 4.42408 3.116 4.212C3.35721 3.89039 3.85011 3.6016 4.53383 3.39123C4.77418 3.31727 5.04571 3.25062 5.35016 3.19488C5.31611 3.14738 5.27808 3.09831 5.23645 3.04945C5.15738 2.95666 5.07893 2.881 5.01081 2.82955C4.98628 2.81102 4.96674 2.79839 4.95217 2.78987C4.28464 2.88582 3.25999 3.24219 2.60954 3.5792C2.42226 3.82162 2.20825 4.24326 2.00729 4.74117C1.79376 5.27021 1.61752 5.82759 1.52025 6.21648C1.19829 7.50369 1.01236 9.06758 0.97986 10.5739C1.18772 10.8918 1.61807 11.2661 2.16148 11.5917C2.64557 11.8818 3.15003 12.0916 3.5468 12.1809C3.64885 12.0385 3.78065 11.843 3.9138 11.6392C3.93626 11.6048 3.95838 11.5708 3.97996 11.5375C3.19521 11.2591 2.77361 10.8758 2.50064 10.4664C2.35359 10.2458 2.4132 9.94778 2.63377 9.80074C2.85435 9.65369 3.15236 9.71329 3.29941 9.93387C3.56077 10.3259 4.24355 11.0201 7.50002 11.0201C10.7565 11.0201 11.4392 10.326 11.7006 9.93386C11.8477 9.71329 12.1457 9.65369 12.3663 9.80074C12.5869 9.94779 12.6465 10.2458 12.4994 10.4664C12.2262 10.8762 11.8041 11.2598 11.0181 11.5382ZM4.08049 7.01221C4.32412 6.74984 4.65476 6.60162 5.00007 6.59998C5.34538 6.60162 5.67603 6.74984 5.91966 7.01221C6.16329 7.27459 6.30007 7.62974 6.30007 7.99998C6.30007 8.37021 6.16329 8.72536 5.91966 8.98774C5.67603 9.25011 5.34538 9.39833 5.00007 9.39998C4.65476 9.39833 4.32412 9.25011 4.08049 8.98774C3.83685 8.72536 3.70007 8.37021 3.70007 7.99998C3.70007 7.62974 3.83685 7.27459 4.08049 7.01221ZM9.99885 6.59998C9.65354 6.60162 9.3229 6.74984 9.07926 7.01221C8.83563 7.27459 8.69885 7.62974 8.69885 7.99998C8.69885 8.37021 8.83563 8.72536 9.07926 8.98774C9.3229 9.25011 9.65354 9.39833 9.99885 9.39998C10.3442 9.39833 10.6748 9.25011 10.9184 8.98774C11.1621 8.72536 11.2989 8.37021 11.2989 7.99998C11.2989 7.62974 11.1621 7.27459 10.9184 7.01221C10.6748 6.74984 10.3442 6.60162 9.99885 6.59998Z"
                            fill="currentColor"></path>
                    </svg>
                    discord
                </a>
                <a href="https://www.instagram.com/radio.cabbage.town/" target="_blank">
                    <svg width="30" height="30" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M12.9091 12.909C13.2365 12.5817 13.4918 12.1895 13.6588 11.7577C13.8195 11.3443 13.9294 10.8718 13.961 10.1799C13.9926 9.48665 14.0001 9.26529 14.0001 7.50001C14.0001 5.73473 13.9926 5.51328 13.961 4.82008C13.9294 4.12821 13.8195 3.65573 13.6588 3.24228C13.4956 2.80857 13.2398 2.41567 12.9091 2.091C12.5844 1.76028 12.1915 1.50437 11.7578 1.34113C11.3443 1.18056 10.8718 1.0707 10.1799 1.03924C9.48675 1.00748 9.26537 1 7.50006 1C5.73476 1 5.51333 1.00748 4.82014 1.03912C4.12826 1.0707 3.65578 1.18056 3.24233 1.34125C2.80862 1.50447 2.41573 1.76032 2.09105 2.09098C1.76032 2.41563 1.5044 2.80852 1.34113 3.24225C1.18056 3.65573 1.0707 4.12821 1.03924 4.82008C1.00748 5.51328 1 5.73471 1 7.50001C1 9.26532 1.00748 9.48675 1.03924 10.1799C1.07083 10.8718 1.18069 11.3443 1.34138 11.7577C1.5046 12.1915 1.76045 12.5843 2.09111 12.909C2.41578 13.2397 2.80867 13.4955 3.24238 13.6587C3.65586 13.8194 4.12834 13.9293 4.82019 13.9609C5.51348 13.9925 5.73483 14 7.50012 14C9.2654 14 9.48685 13.9925 10.18 13.9609C10.8719 13.9293 11.3444 13.8194 11.7578 13.6587C12.1896 13.4917 12.5818 13.2364 12.9091 12.909ZM1.99949 6.73496C1.99974 6.94524 2.00005 7.19543 2.00005 7.50002C2.00005 7.80461 1.99974 8.0548 1.99949 8.26507C1.99849 9.08596 1.99824 9.29856 2.01963 9.7655C2.04625 10.3509 2.07823 10.7811 2.17588 11.1053C2.26976 11.417 2.37505 11.7342 2.7188 12.1171C3.06255 12.4999 3.39411 12.6733 3.81645 12.8007C4.23879 12.928 4.7696 12.9554 5.23052 12.9764C5.75332 13.0003 5.96052 13.0002 7.05714 12.9999L7.50006 12.9999C7.79304 12.9999 8.03569 13.0001 8.2409 13.0004C9.08195 13.0013 9.29425 13.0015 9.76575 12.9799C10.3512 12.9533 10.7814 12.9213 11.1056 12.8237C11.4173 12.7298 11.7345 12.6245 12.1173 12.2807C12.5001 11.937 12.6735 11.6054 12.8009 11.1831C12.9283 10.7607 12.9557 10.2299 12.9767 9.76902C13.0005 9.24689 13.0004 9.04027 13.0002 7.94749V7.94738L13.0001 7.50039L13.0001 7.05747C13.0004 5.96085 13.0005 5.75365 12.9766 5.23085C12.9556 4.76993 12.9282 4.23912 12.8009 3.81678C12.6735 3.39445 12.5001 3.06288 12.1173 2.71913C11.7345 2.37538 11.4172 2.27009 11.1056 2.17621C10.7813 2.07856 10.3511 2.04658 9.76571 2.01996C9.29421 1.99836 9.08194 1.99859 8.24092 1.99951H8.24092C8.0357 1.99974 7.79305 2.00001 7.50006 2.00001L7.05704 1.99993C5.96051 1.99964 5.75331 1.99958 5.23052 2.02343C4.7696 2.04446 4.23879 2.07183 3.81645 2.19921C3.39411 2.32659 3.06255 2.49999 2.7188 2.88281C2.37505 3.26562 2.26976 3.58286 2.17588 3.89453C2.07823 4.21874 2.04625 4.64894 2.01963 5.23437C1.99824 5.70131 1.99849 5.91401 1.99949 6.73496ZM7.49996 5.25015C6.25741 5.25015 5.25012 6.25744 5.25012 7.49999C5.25012 8.74254 6.25741 9.74983 7.49996 9.74983C8.74251 9.74983 9.7498 8.74254 9.7498 7.49999C9.7498 6.25744 8.74251 5.25015 7.49996 5.25015ZM4.25012 7.49999C4.25012 5.70515 5.70512 4.25015 7.49996 4.25015C9.2948 4.25015 10.7498 5.70515 10.7498 7.49999C10.7498 9.29483 9.2948 10.7498 7.49996 10.7498C5.70512 10.7498 4.25012 9.29483 4.25012 7.49999ZM10.9697 4.7803C11.3839 4.7803 11.7197 4.44452 11.7197 4.0303C11.7197 3.61609 11.3839 3.2803 10.9697 3.2803C10.5555 3.2803 10.2197 3.61609 10.2197 4.0303C10.2197 4.44452 10.5555 4.7803 10.9697 4.7803Z"
                            fill="currentColor"></path>
                    </svg>
                    instagram
                </a>
            </p>

            <br />

            <p style="font-size: 0.8em; color: grey;">want to host a show? we're always looking for new cabbages, dm us
                on <a href="https://www.instagram.com/radio.cabbage.town/" target="_blank">instagram</a> or email us at
                <a href="mailto:cabbagedotradio@gmail.com">cabbagedotradio@gmail.com</a>
            </p>
            <p style="font-size: 0.8em; color: grey;">all show times are eastern.</p>
        </div>
    </div>

</body>
<script src="cursors.js"></script>
<script>
    // !!All dates/times are in utc!!
    // https://www.worldtimebuddy.com/
    const liveShows = [{
        name: "the mulch channel",
        dj: "ted",
        dayOfWeek: 2,
        startHour: 1,
    }, {
        name: "The IS WiLD hour",
        dj: "DJ Chicago Style",
        dayOfWeek: 3,
        startHour: 0,
    }, {
    }, {
        name: "tracks from terminus",
        dj: "the conductor",
        dayOfWeek: 3,
        startHour: 2,
    }, {
        name: "the reginajingles show",
        dj: "reginajingles",
        dayOfWeek: 4,
        startHour: 1,
    }, {
        name: "late nights like these",
        dj: "nights like these",
        dayOfWeek: 5,
        startHour: 1,
    }]

    const dayOfWeek = new Date().getUTCDay()
    const hour = new Date().getUTCHours()
    let liveShow = undefined;

    const checkForLiveShows = () => {
        liveShow = liveShows.find(show => {
            return show.dayOfWeek === dayOfWeek && hour === show.startHour
        })

        if (liveShow) {
            updateLiveShowBanner()
        }
    }

    const updateLiveShowBanner = () => {
        const liveShowBanner = document.getElementById('live-show-banner')
        if (!liveShowBanner) {
            return;
        }

        if (!liveShow) {
            liveShowBanner.style.display = 'none';
            return;
        }

        liveShowBanner.innerHTML = `(LIVE) ${liveShow.name} w/ ${liveShow.dj}`
        liveShowBanner.style.display = 'inline-block';
    }

    checkForLiveShows();
    setInterval(checkForLiveShows, 1000 * 60)
</script>
<script>
    async function updateNowPlaying() {
        const res = await fetch('https://radio.cabbage.town/api/nowplaying/cabbage.town', {
            method: 'GET'
        });

        if (!res.ok) {
            console.error('Error fetching now playing data:', res.statusText);
            return;
        }

        const data = await res.json();
        console.log('Now playing data:', data);
        const live = data.live;
        if (live.is_live) {
            const streamerName = live.streamer_name;
            const liveStreamerName = document.getElementById('liveStreamerName');
            liveStreamerName.innerHTML = `(LIVE) <strong>${streamerName}</strong>`;
            liveStreamerName.style.display = 'block';
        } else {
            const liveStreamerName = document.getElementById('liveStreamerName');
            liveStreamerName.style.display = 'none';
        }

        const song = data.now_playing.song;
        const artist = song.artist;
        const title = song.title;
        const art = song.art;

        console.log('Now playing:', artist, '-', title);
        const nowPlayingArtwork = document.getElementById('nowPlayingArtwork');
        nowPlayingArtwork.src = art;
        nowPlayingArtwork.alt = `${artist} - ${title}`;
        const nowPlayingArtist = document.getElementById('nowPlayingArtist');
        nowPlayingArtist.innerHTML = `<strong>${artist}</strong>`;
        const nowPlayingTitle = document.getElementById('nowPlayingTitle');
        nowPlayingTitle.innerHTML = `<em>${title}</em>`;
    }

    (async () => {
        await updateNowPlaying();
        setInterval(updateNowPlaying, 1000 * 15);
    })();
</script>

</html>